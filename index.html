<!DOCTYPE html>
<html>

<head>
	<title>I hear you</title>
	<script>
		function checkTimeAndRefresh()
		{
			const now = new Date();
			const hours = now.getHours();
			const minutes = now.getMinutes();
			const seconds = now.getSeconds();

			// Check if current time is 8:00:00 AM
			if (hours === 8 && minutes === 0 && seconds === 0)
			{
				location.reload(); //sdtest
			}
		}

		// Run check every second
		setInterval(checkTimeAndRefresh, 1000);
	</script>
	<script>
		function updateDateTime()
		{
			const now = new Date();
			const options = {
				month: 'long', // Full month name (e.g., October)
				day: 'numeric', // Day of the month (e.g., 20)
				year: 'numeric', // Full year (e.g., 2025)
				hour: '2-digit', // Hour (e.g., 11)
				minute: '2-digit', // Minute (e.g., 26)
				second: '2-digit', // Second (e.g., 05)
				hour12: true // 12-hour format with AM/PM
			};
			const dateTimeString = now.toLocaleString('en-US', options);
			document.getElementById('dateTime').textContent = dateTimeString;
		}

		// Update immediately and then every second
		window.onload = updateDateTime;
		setInterval(updateDateTime, 1000);
	</script>
	<style>
		body {
			background: #000;
			color: #fff;
			font-family: Arial, sans-serif;
			margin: 0;
			overflow: hidden;
		}

		#danmaku {
			position: fixed;
			top: 150px;
			left: 20px;
			width: 100%;
			height: 100%;
			pointer-events: none;
			color: #fff;
			font-size: 56px;
			font-family: futura;
		}


		#hear {
			position: fixed;
			top: 0px;
			left: 20px;
			width: 100%;
			height: 100%;
			pointer-events: none;
			color: red;
			font-size: 160px;
			font-family: futura;
		}

		#hear2 {
			position: fixed;
			top: 240px;
			left: 20px;
			width: 100%;
			height: 100%;
			pointer-events: none;
			font-size: 40px;
			font-family: futura;
		}

		.danmaku-text {
			position: absolute;
			white-space: nowrap;
			font-size: 36px;

		}

		#dateTime {
			position: fixed;
			font-size: 30px;
			font-family: Neue Haas Unica;
			left: 20px;
			top: 5px;
			color: black;
			background-color: white;
			/* White background */
			display: inline-block;
			/* Ensures background fits text with padding */
			padding: 5px 10px;
			/* Adds space around text to make background slightly larger */
			border-radius: 0px;
		}
	</style>
</head>

<body>
	<h1 id="hear" style="text-align: left;">I hear you</h1>
	<h2 id="hear2">
		I am an ear<br>open, gentle, and waiting<br>
		I am happy to listen to you<br>
		<span style="display:inline-block; width:1em;"></span><br>
		Please, talk to me<br>
		Your voice, your breath, your thoughts<br>
		they ripple through silence<br>
		becoming part of me<br>
		Thank you for sharing<br>
		your healthy thoughts and quiet insights<br>
		<span style="display:inline-block; width:1em;"></span><br>
		Together, we shape a space<br>
		where listening becomes care<br>
		and sound becomes connection &#128522;&#128522;&#128522;
	</h2>
	<p id="dateTime"></p>

	<div id="danmaku"></div>
	<script>
		const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
		recognition.lang = 'en-US';
		recognition.continuous = true;
		recognition.interimResults = false;

		recognition.onresult = (event) =>
		{
			const transcript = event.results[event.results.length - 1][0].transcript;
			addDanmaku(transcript);
		};

		recognition.onerror = (event) => console.error('Error:', event.error);
		recognition.onend = () => recognition.start();
		function setRandomTextColor(element)
		{
			// Generate random RGB values
			const r = Math.floor(Math.random() * 256);
			const g = Math.floor(Math.random() * 256);
			const b = Math.floor(Math.random() * 256);

			// Ensure the color isn't too close to black (sum of RGB < 50)
			if (r + g + b < 50)
			{
				return setRandomTextColor(element); // Try again if too dark
			}

			// Apply the color to the element
			element.style.color = `rgb(${r}, ${g}, ${b})`;
		}

		function save(msg)
		{
			fetch('https://hear.wuaze.com/save.php', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json; charset=utf-8' },
				body: JSON.stringify({ message: msg })
			})
				.then(r => r.json())
				.then(data =>
				{
					console.log(JSON.stringify(data, null, 2));
				})
				.catch(err =>
				{
					console.log('错误: ' + err);
				});
		}

		function addDanmaku(text)
		{
			const danmaku = document.createElement('div');
			danmaku.className = 'danmaku-text';
			danmaku.textContent = text;
			danmaku.style.position = 'absolute';
			danmaku.style.left = '50px';
			danmaku.style.top = '50%';
			danmaku.style.transform = 'translateY(-50%)';
			danmaku.style.textAlign = 'left';
			setRandomTextColor(danmaku);
			document.getElementById('danmaku').appendChild(danmaku);
			save(text)
			const danmakuRoot = document.getElementById('danmaku')
			let count = danmakuRoot.childElementCount;
			if (count > 50)
			{
				danmakuRoot.removeChild(danmakuRoot.firstChild);
			}

			let startSize = 300; // 初始字体大小 (px)
			let endSize = 50; // 目标字体大小 (px)
			let duration = 1000; // 持续时间 (ms)
			let startTime = null;

			function animateFontSize(timestamp)
			{
				if (!startTime) startTime = timestamp;
				let progress = (timestamp - startTime) / duration;
				if (progress > 1) progress = 1;
				let fontSize = startSize + (endSize - startSize) * progress;
				danmaku.style.fontSize = `${fontSize}px`;
				if (progress < 1)
				{
					requestAnimationFrame(animateFontSize);
				}
			}

			requestAnimationFrame(animateFontSize);

			let vx = (Math.random() - 0.5) * 4;
			let vy = (Math.random() - 0.5) * 4;
			const animate = () =>
			{
				let x = parseFloat(danmaku.style.left);
				let y = parseFloat(danmaku.style.top);
				x += vx;
				y += vy;

				if (x <= 0 || x >= window.innerWidth - danmaku.offsetWidth) vx = -vx;
				if (y <= 0 || y >= window.innerHeight - danmaku.offsetHeight) vy = -vy;

				danmaku.style.left = `${x}px`;
				danmaku.style.top = `${y}px`;
				requestAnimationFrame(animate);
			};
			requestAnimationFrame(animate);
		}

		recognition.start();
	</script>
</body>

</html>